<!DOCTYPE html>
<html lang="tr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>ğŸ’£ Emoji Bomb V6 - SÄ±ra KontrolÃ¼</title>
Â  Â  
Â  Â  Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
Â  Â  
Â  Â  <style>
Â  Â  Â  Â  /* === CSS STÄ°LLERÄ° === */
Â  Â  Â  Â  
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --primary-color: #3498db;
Â  Â  Â  Â  Â  Â  --secondary-color: #2980b9;
Â  Â  Â  Â  Â  Â  --success-color: #2ecc71;
Â  Â  Â  Â  Â  Â  --danger-color: #e74c3c;
Â  Â  Â  Â  Â  Â  --text-color: #2c3e50;
Â  Â  Â  Â  Â  Â  --bg-color: #ecf0f1;
Â  Â  Â  Â  Â  Â  --card-bg: white;
Â  Â  Â  Â  Â  Â  --shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  * { -webkit-tap-highlight-color: transparent; }
Â  Â  Â  Â  body { 
Â  Â  Â  Â  Â  Â  font-family: sans-serif; 
Â  Â  Â  Â  Â  Â  background-color: var(--bg-color); 
Â  Â  Â  Â  Â  Â  color: var(--text-color); 
Â  Â  Â  Â  Â  Â  min-height: 100vh; 
Â  Â  Â  Â  Â  Â  display: flex; 
Â  Â  Â  Â  Â  Â  align-items: center; 
Â  Â  Â  Â  Â  Â  justify-content: center; 
Â  Â  Â  Â  Â  Â  overflow-x: hidden; 
Â  Â  Â  Â  Â  Â  overflow-y: auto; 
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s; 
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 500px;
Â  Â  Â  Â  Â  Â  margin: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  .screen { 
Â  Â  Â  Â  Â  Â  width: 100%; 
Â  Â  Â  Â  Â  Â  max-width: 500px; 
Â  Â  Â  Â  Â  Â  display: none; 
Â  Â  Â  Â  Â  Â  flex-direction: column; 
Â  Â  Â  Â  Â  Â  align-items: center; 
Â  Â  Â  Â  Â  Â  padding: 1.5rem; 
Â  Â  Â  Â  Â  Â  box-sizing: border-box; 
Â  Â  Â  Â  Â  Â  text-align: center; 
Â  Â  Â  Â  Â  Â  background-color: var(--card-bg); 
Â  Â  Â  Â  Â  Â  border-radius: 12px; 
Â  Â  Â  Â  Â  Â  box-shadow: var(--shadow); 
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s; 
Â  Â  Â  Â  }
Â  Â  Â  Â  .screen.active { display: flex; }
Â  Â  Â  Â  
Â  Â  Â  Â  /* Utility */
Â  Â  Â  Â  .btn { @apply w-full text-xl font-bold py-3 px-6 rounded-xl shadow-lg transition-all duration-200 ease-in-out; }
Â  Â  Â  Â  .btn-primary { @apply bg-blue-600 text-white hover:bg-blue-500 active:scale-95; }
Â  Â  Â  Â  .input-field { @apply w-full text-lg bg-gray-200 text-gray-900 border-2 border-gray-400 rounded-lg p-3 text-center placeholder-gray-500 focus:outline-none focus:border-blue-500; }
Â  Â  Â  Â  .code-display { @apply text-4xl font-extrabold p-4 bg-gray-800 text-yellow-300 rounded-lg tracking-widest; }
Â  Â  Â  Â  
Â  Â  Â  Â  /* Global Mesaj */
Â  Â  Â  Â  #globalMessage.show { 
Â  Â  Â  Â  Â  Â  display: block; 
Â  Â  Â  Â  Â  Â  position: fixed; 
Â  Â  Â  Â  Â  Â  top: 20px; 
Â  Â  Â  Â  Â  Â  left: 50%; 
Â  Â  Â  Â  Â  Â  transform: translateX(-50%); 
Â  Â  Â  Â  Â  Â  z-index: 50; 
Â  Â  Â  Â  Â  Â  animation: fadeInDown 0.3s ease-out; 
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes fadeInDown {
Â  Â  Â  Â  Â  Â  from { opacity: 0; transform: translate(-50%, -20px); }
Â  Â  Â  Â  Â  Â  to { opacity: 1; transform: translate(-50%, 0); }
Â  Â  Â  Â  }

Â  Â  Â  Â  /* OYUN TAHTASI */
Â  Â  Â  Â  .memory-board { display: grid; gap: 8px; padding: 5px 0; }
Â  Â  Â  Â  .card-container { perspective: 1000px; aspect-ratio: 1; }
Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  width: 100%; height: 100%; border-radius: 10px; cursor: default;
Â  Â  Â  Â  Â  Â  position: relative; transform-style: preserve-3d; 
Â  Â  Â  Â  Â  Â  transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-container.cursor-pointer .card { cursor: pointer; }

Â  Â  Â  Â  .card.flipped { transform: rotateY(180deg); }
Â  Â  Â  Â  .card-face {
Â  Â  Â  Â  Â  Â  position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
Â  Â  Â  Â  Â  Â  display: flex; justify-content: center; align-items: center;
Â  Â  Â  Â  Â  Â  border-radius: 10px; font-size: 1.5rem; font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-face.front {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
Â  Â  Â  Â  Â  Â  color: white; border: 3px solid var(--card-bg); transform: rotateY(0deg); z-index: 2;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-face.back {
Â  Â  Â  Â  Â  Â  background: var(--card-bg); color: var(--text-color); transform: rotateY(180deg); z-index: 1;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card.bomb-selected .card-face.front {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #f39c12, #e74c3c); 
Â  Â  Â  Â  Â  Â  animation: pulse-red 0.5s infinite alternate;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes pulse-red { from { opacity: 1; } to { opacity: 0.8; } }
Â  Â  </style>
</head>
<body class="bg-gray-900 select-none">

Â  Â  <div id="globalMessage" class="hidden w-11/12 max-w-md p-4 bg-red-600 text-white rounded-lg shadow-lg">
Â  Â  Â  Â  <p id="globalMessageText"></p>
Â  Â  </div>

Â  Â  <div id="lobby" class="screen active space-y-6 container">
Â  Â  Â  Â  <h1 class="text-5xl font-black text-gray-900">ğŸ’£ Emoji Bomb</h1>
Â  Â  Â  Â  <p class="text-gray-700">Sunucuya baÄŸlÄ±. KullanÄ±cÄ± adÄ±nÄ±zÄ± girin.</p>
Â  Â  Â  Â  
Â  Â  Â  Â  <input type="text" id="username" class="input-field" placeholder="KullanÄ±cÄ± AdÄ±">
Â  Â  Â  Â  <input type="text" id="roomCodeInput" class="input-field uppercase" placeholder="Oda NumarasÄ± (BoÅŸ bÄ±rak=OluÅŸtur)">
Â  Â  Â  Â  
Â  Â  Â  Â  <button id="matchBtn" class="btn btn-primary">ğŸ® Oda OluÅŸtur / Odaya Gir</button>
Â  Â  </div>
Â  Â  
Â  Â  <div id="waitScreen" class="screen space-y-6 container">
Â  Â  Â  Â  <h2 id="waitTitle" class="text-3xl font-bold text-gray-900">Oda Kuruluyor...</h2>
Â  Â  Â  Â  <div id="codeArea" class="space-y-3 hidden">
Â  Â  Â  Â  Â  Â  <p class="text-lg text-gray-700">Oda Kodunuz:</p>
Â  Â  Â  Â  Â  Â  <div id="roomCodeDisplay" class="code-display"></div>
Â  Â  Â  Â  Â  Â  <button id="copyCodeBtn" class="btn bg-gray-600 text-white text-base py-2 max-w-xs">Kopyala</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p id="waitStatus" class="text-lg text-gray-700">Rakip bekleniyor...</p>
Â  Â  Â  Â  <button id="cancelBtn" class="btn bg-red-600 text-base py-3 max-w-xs">Ä°ptal Et</button>
Â  Â  </div>

Â  Â  <div id="gameScreen" class="screen space-y-6 container">
Â  Â  Â  Â  <h1 class="text-5xl font-black text-gray-900">ğŸ•¹ï¸ Emoji Bomb</h1>
Â  Â  Â  Â  
Â  Â  Â  Â  <div class="flex justify-between w-full text-gray-800 font-bold p-2 border-b border-gray-300">
Â  Â  Â  Â  Â  Â  <p>Siz: <span id="myLives" class="text-green-600">â¤ï¸â¤ï¸</span></p>
Â  Â  Â  Â  Â  Â  <p>Rakip: <span id="opponentName" class="text-blue-600"></span></p>
Â  Â  Â  Â  Â  Â  <p>Can: <span id="opponentLives" class="text-green-600">â¤ï¸â¤ï¸</span></p>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p id="roleStatus" class="text-gray-700 text-sm"></p>

Â  Â  Â  Â  <div id="gameContent" class="p-4 bg-gray-200 rounded-lg w-full space-y-4">
Â  Â  Â  Â  Â  Â  <h3 id="turnStatus" class="text-2xl font-bold text-red-600">Rakip bekleniyor...</h3>
Â  Â  Â  Â  Â  Â  <p id="actionMessage" class="text-base text-purple-600 font-semibold"></p>
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  <div id="gameBoard" class="grid w-full max-w-sm mx-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  <button id="endGameBtn" class="btn bg-gray-600 text-white text-base py-3 max-w-xs">Lobiye DÃ¶n</button>
Â  Â  </div>
    
    <audio id="BOMB_SOUND" src="sound1.mp3" preload="auto"></audio>
    <audio id="EMOJI_SOUND" src="sound2.mp3" preload="auto"></audio>
    <audio id="WAIT_SOUND" src="sound3.mp3" preload="auto"></audio>

Â  Â  <script type="module">
Â  Â  Â  Â  // KRÄ°TÄ°K: game.js bir modÃ¼l olarak yÃ¼kleniyor
Â  Â  Â  Â  import { setupSocketHandlers, showScreen, UIElements, gameData, isHost, level, LEVELS } from './game.js';

Â  Â  Â  Â  // KRÄ°TÄ°K ADRES: Kendi Render URL'niz
Â  Â  Â  Â  const LIVE_SERVER_URL = 'https://beta-github-io.onrender.com'; 
Â  Â  Â  Â  let socket;
Â  Â  Â  Â  
Â  Â  Â  Â  function validateInput() {
Â  Â  Â  Â  Â  Â  const username = UIElements.usernameInput.value.trim();
Â  Â  Â  Â  Â  Â  if (username.length < 2) {
Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage('LÃ¼tfen geÃ§erli bir kullanÄ±cÄ± adÄ± girin.', true);
Â  Â  Â  Â  Â  Â  Â  Â  return false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return username;
Â  Â  Â  Â  }

Â  Â  Â  Â  function connectToServer() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  socket = io(LIVE_SERVER_URL, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  transports: ['websocket', 'polling'], 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reconnectionAttempts: 5, 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  timeout: 20000 
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  socket.on('connect', () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage('Sunucuya baÄŸlandÄ±. EÅŸleÅŸmeye hazÄ±rsÄ±nÄ±z.', false);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showScreen('lobby');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  socket.on('connect_error', (err) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('BaÄŸlantÄ± HatasÄ±:', err);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage('HATA: Sunucuya eriÅŸilemiyor. Render URL doÄŸru mu?', true);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showScreen('lobby');
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  socket.on('disconnect', () => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage('BaÄŸlantÄ± kesildi. Tekrar baÄŸlanmaya Ã§alÄ±ÅŸÄ±lÄ±yor...', true);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  // --- EÅŸleÅŸme OlaylarÄ± ---
Â  Â  Â  Â  Â  Â  Â  Â  socket.on('roomCreated', (code) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('roomCodeDisplay').textContent = code;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('waitTitle').textContent = 'OdanÄ±z Kuruldu!';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('codeArea').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('waitStatus').textContent = 'Oda kodunu arkadaÅŸÄ±nÄ±za gÃ¶nderin ve baÄŸlanmasÄ±nÄ± bekleyin.';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showScreen('wait');
Â  Â  Â  Â  Â  Â  Â  Â  });

                socket.on('roomJoined', (code) => {
                    document.getElementById('waitTitle').textContent = `Odaya KatÄ±lÄ±m: ${code}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('waitStatus').textContent = 'Oda bulundu, oyunun baÅŸlamasÄ± bekleniyor.';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('codeArea').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showScreen('wait');
                });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  socket.on('joinFailed', (message) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage(message, true);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  UIElements.resetGame();
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  socket.on('gameStart', ({ players, initialGameData }) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const opponent = players.find(p => p.id !== socket.id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const self = players.find(p => p.id === socket.id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // setupSocketHandlers imzasÄ±na uyumlu gÃ¶nderim
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setupSocketHandlers(socket, UIElements.roomCodeInput.value, self.username, opponent.username, self.isHost, initialGameData);
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Socket.IO genel hatasÄ±:', e);
Â  Â  Â  Â  Â  Â  Â  Â  UIElements.showGlobalMessage('Kritik baÄŸlantÄ± hatasÄ± oluÅŸtu.', true);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  
Â  Â  Â  Â  // --- Olay Dinleyicileri ---
Â  Â  Â  Â  UIElements.matchBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const username = validateInput();
Â  Â  Â  Â  Â  Â  if (!username) return;
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const roomCode = UIElements.roomCodeInput.value.trim().toUpperCase();

Â  Â  Â  Â  Â  Â  if (roomCode === '') {
Â  Â  Â  Â  Â  Â  Â  Â  socket.emit('createRoom', { username });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  socket.emit('joinRoom', { username, roomCode });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  document.getElementById('cancelBtn').addEventListener('click', UIElements.resetGame);
Â  Â  Â  Â  
Â  Â  Â  Â  // Yeni Seviye/Oyunu Bitir Butonunun Dinleyicisi
        document.getElementById('endGameBtn').addEventListener('click', () => {
            if (gameData && gameData.gameStage === 'ENDED' && isHost) {
                if (level < LEVELS.length) {
                    // Host olarak bir sonraki seviyeye geÃ§me sinyalini gÃ¶nder
                    socket.emit('nextLevel', { roomCode: UIElements.roomCodeInput.value });
                } else {
                     UIElements.showGlobalMessage("TÃ¼m seviyeler tamamlandÄ±!", false);
                     UIElements.resetGame();
                }
            } else {
                 UIElements.resetGame(); // Oyun bitmemiÅŸse veya Guest ise lobiye dÃ¶n
            }
        });
Â  Â  Â  Â  
Â  Â  Â  Â  document.getElementById('copyCodeBtn').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const textToCopy = document.getElementById('roomCodeDisplay').textContent;
Â  Â  Â  Â  Â  Â  navigator.clipboard.writeText(textToCopy)
Â  Â  Â  Â  Â  Â  Â  Â  .then(() => UIElements.showGlobalMessage('Oda Kodu KopyalandÄ±!', false))
Â  Â  Â  Â  Â  Â  Â  Â  .catch(() => UIElements.showGlobalMessage('Kopyalama baÅŸarÄ±sÄ±z.', true));
Â  Â  Â  Â  });

Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', connectToServer);
Â  Â  </script>
</body>
</html>
